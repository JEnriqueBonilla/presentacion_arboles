data
data %>%
ggplot(aes(x = cp, y = xerror, label = nsplit)) +
geom_point() + geom_line() + geom_text()
options(digits=2)
data(BostonHousing)
set.seed(15)
train <- sample(1:nrow(BostonHousing),400)
BostonHousing$train <- F
BostonHousing$train[train] <- T
entrena_arb <- BostonHousing[BostonHousing$train,]
prueba_arb <- BostonHousing[!BostonHousing$train,]
entrena_arb$train <- NULL
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=10))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(compledijdad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = cp, y = xerror, label = nsplit)) +
geom_point() + geom_line() + geom_text()
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=10))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = round(CP, 4))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_point() + geom_line() + geom_text()
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() + geom_text()
complejidad
complejidad %>%
dplyr::select(nsplit, cp, xerror)
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = TRUE)
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = TRUE)
complejidad %>%
dplyr::select(nsplit, cp, xerror)
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=10))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = TRUE)
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T) + geom_label()
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45)
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45) +
xlab("Tamaño del árbol") + ylab("Error de validación cruzada (10)")
complejidad %>%
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=20))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=20))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45) +
xlab("Tamaño del árbol") + ylab("Error de validación cruzada (10)")
complejidad$cp
alpha <- complejidad$cp
modelo_arb_completo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=0 , xval=10, minbucket=1))
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45) +
xlab("Tamaño del árbol") + ylab("Error de validación cruzada (10)")
complejidad %>%
dplyr::select(nsplit, cp, xerror)
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 6)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45) +
xlab("Tamaño del árbol") + ylab("Error de validación cruzada (10)")
complejidad %>%
dplyr::select(nsplit, cp, xerror)
complejidad <- modelo_arb_completo$cptable %>%
data.frame %>%
mutate(CP = as.character(round(CP, 4)))
names(complejidad) <- c("cp","nsplit", "rel_error", "xerror", "xstd")
complejidad %>%
ggplot(aes(x = nsplit, y = xerror, label = cp)) +
geom_line() +geom_text(check_overlap = T, angle = 45) +
xlab("Tamaño del árbol") + ylab("Error de validación cruzada (10)")
complejidad %>%
dplyr::select(nsplit, cp, xerror) %>%
head(80)
complejidad %>%
dplyr::select(nsplit, cp, xerror) %>%
head(60)
alpha <- complejidad$cp
predicted <- predict(spam_tree_completo, type="class")
1-mean(predicted==spam.train$spam)
i <- 0
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
error.entrena
error.prueba
i <- 0.0016
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
data.frame(alpha = i, prueba = error.prueba,
error.entrena
error.prueba
errores.vmc <- ldply(alpha,
function(i) {
i <- 0.0016
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
data.frame(alpha = i, prueba = error.prueba,
entrenamiento = error.entrena)
})
library(tidyr)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggdendro)
library(tree)
library(rpart)
library(mlbench) #data BostonHousing
errores.vmc <- ldply(alpha,
function(i) {
i <- 0.0016
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
data.frame(alpha = i, prueba = error.prueba,
entrenamiento = error.entrena)
})
data(BostonHousing)
set.seed(111)
train<-sample(1:nrow(BostonHousing),400)
BostonHousing$train<-FALSE
BostonHousing$train[train]<-TRUE
BostonHousing_train<-BostonHousing[BostonHousing$train,]
BostonHousing_test<-BostonHousing[!BostonHousing$train,]
BostonHousing_train$train<-NULL
arbol_housing <- rpart(medv~.,data=BostonHousing_train,method="anova",control=rpart.control(cp=0.001,xval=10))
printcp(arbol_housing)
plotcp(arbol_housing)
mean((predict(arbol_housing, BostonHousing_test)-BostonHousing_test$medv)^2)
library(randomForest)
library(rpart)
library(mlbench)
data(BostonHousing)
set.seed(111)
train<-sample(1:nrow(BostonHousing),400)
BostonHousing$train<-FALSE
BostonHousing$train[train]<-TRUE
BostonHousing_train<-BostonHousing[BostonHousing$train,]
BostonHousing_test<-BostonHousing[!BostonHousing$train,]
BostonHousing_train$train<-NULL
arbol_housing <- rpart(medv~.,data=BostonHousing_train,method="anova",control=rpart.control(cp=0.001,xval=10))
printcp(arbol_housing)
plotcp(arbol_housing)
mean((predict(arbol_housing, BostonHousing_test)-BostonHousing_test$medv)^2)
errores.vmc
errores.vmc <- ldply(alpha,
function(i) {
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
data.frame(alpha = i, prueba = error.prueba,
entrenamiento = error.entrena)
})
err.m <- errores.vmc %>%
errores.vmc
errores.vmc <- ldply(alpha,
function(i) {
modelo <- rpart(medv~., data = entrena_arb, method = "anova",
control=rpart.control(cp=i , xval=10, minbucket=1))
error.entrena <- mean((predict(modelo) - entrena_arb$medv)^2)
error.prueba <- mean((predict(modelo, prueba_arb)- prueba_arb$medv)^2)
data.frame(alpha = as.numeric(i), prueba = error.prueba,
entrenamiento = error.entrena)
})
errores.vmc
library(randomForest)
library(rpart)
library(mlbench)
data(BostonHousing)
set.seed(15)
train<-sample(1:nrow(BostonHousing),400)
BostonHousing$train<-FALSE
BostonHousing$train[train]<-TRUE
BostonHousing_train<-BostonHousing[BostonHousing$train,]
BostonHousing_test<-BostonHousing[!BostonHousing$train,]
BostonHousing_train$train<-NULL
arbol_housing <- rpart(medv~.,data=BostonHousing_train,method="anova",control=rpart.control(cp=0.001,xval=10))
printcp(arbol_housing)
install.packages("tufte")
library(tufte)
install.packages("ggplot2")
require(ggdendro)
install.packages("ggdendro")
install.packages("plyr")
install.packages("dplyr")
install.packages("kknn")
install.packages("tidyr")
install.packages("rpart")
install.packages("tree")
install.packages("mlbench")
install.packages("randomForest")
install.packages("gbm")
library(tidyr)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggdendro)
library(tree)
library(rpart)
library(mlbench) #data BostonHousing
control.completo <- rpart.control(cp=0, minsplit=10,
minbucket=1, xval=10, maxdepth=30)
arbol1 <- tree(Species ~ Sepal.Width + Petal.Width, data = iris)
arbol2 <- rpart(Species ~ Sepal.Width + Petal.Width, method = "class",
data = iris, control = control.completo)
ddata <- dendro_data(arbol2, uniform =T)
ggplot() +
geom_segment(data = ddata$segments,
aes(x = x, y = y, xend = xend, yend = yend), colour = "brown", size = 1) +
geom_text(data = ddata$labels,
aes(x = x, y = y, label = label), colour = "#006633", size = 5, vjust = -1) +
geom_text(data = ddata$leaf_labels,
aes(x = x, y = y, label = label), colour = "#006633", size = 5, vjust = 1) +
theme_dendro() #+ scale_y_reverse(expand = c(0.2, 0)) + coord_polar(theta="x")
plot(iris$Petal.Width, iris$Sepal.Width, pch=19,col=as.numeric(iris$Species))
partition.tree(arbol1, label="Species", add = T)
legend(1.75,4.5,legend=unique(iris$Species),col=unique(as.numeric(iris$Species)),pch=19)
gini <- f(p){
f <- 1-p^2 -(1-p)^2
return(f)
}
gini <- function(p){
f <- 1-p^2 -(1-p)^2
return(f)
}
entropia <- function(p){
f <- -p*log(p) - (1-p)*log(1-p)
return(f)
}
clasificacion <- function(p){
f <- (1-p)
return(f)
}
datos <- data.frame(x = seq(0, 1, by=.01 ), gini = gini(x),
entropia = entropia(x), clasificacion = clasificacion(x))
datos <- data.frame(x = seq(0, 1, by=.01 ))
datos <- data.frame(x = seq(0, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x))
datos
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x))
datos %>% gggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
clasificacion <- function(p){
f <- (1-max(p,1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
p <- .5
max(p,1-p)
p <- .3
max(p,1-p)
datos
clasificacion <- function(p){
f <- (1-max(p,1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
clasificacion <- function(p){
f <- max(p,1-p)
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x))
clasificacion <- function(p){
f <- max(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)
)
clasificacion(.5)
clasificacion(.2)
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x)) %>%
mutate(clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
ungroup() %>%
mutate(gini = gini(x), entropia = entropia(x)) %>%
mutate(clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
clasificacion(datos$x)
clasificacion <- function(p){
f <- pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
gather(variable, valor, -x)
geom_line()
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line()
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
entropia <- function(p){
f <- -p*log10(p) - (1-p)*log10(1-p)
return(f)
}
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
entropia <- function(p){
f <- -p*log2(p) - (1-p)*log2(1-p)
return(f)
}
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
f <- f/2
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
entropia <- function(p){
f <- -p*log2(p) - (1-p)*log2(1-p)
f <- f/2
return(f)
}
clasificacion <- function(p){
f <- 1-pmax(p,(1-p))
return(f)
}
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos <- data.frame(x = seq(0.0001, 1, by=.01 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos
datos <- data.frame(x = seq(from = 0.0001,to = 1, by=.01 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos
datos <- data.frame(x = seq(from = 0.1,to = 1, by=.01 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos <- data.frame(x = seq(0.1, 1, .0001 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos
datos <- data.frame(x = seq(0.01, 1, length =100 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos
datos <- data.frame(x = seq(0.01, .999, length =100 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos <- data.frame(x = seq(0.001, .999, length =100 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
datos <- data.frame(x = seq(0.001, .999, length =300 )) %>%
mutate(gini = gini(x), entropia_escalada = entropia(x),
clasificacion = clasificacion(x)) %>%
gather(variable, valor, -x)
datos %>% ggplot(aes(x = x, y = valor, group = variable, color = variable)) +
geom_line() + ylab("y")
